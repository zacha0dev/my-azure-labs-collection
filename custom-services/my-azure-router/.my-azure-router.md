[<- Go Back](../.custom-services.md)

# My Azure Router 
The **My Azure Router** is a lightweight, Python-based router framework for testing and validating routing behavior in both local and Azure environments. It can simulate route propagation, peer with Azure Route Server and Azure Virtual Wan, and serve as a minimal NVA for proof-of-concept topologies.

### Router Overview 
- **Data Plane**: move packets/messages through “interfaces,” apply route lookups, NAT/policy, and counters.
- **Control Plane**: learn and advertise routes (BGP first), manage peering, install/remove routes in the FIB.
- **Management Plane**: lifecycle (start/stop), config, telemetry, and safe upgrades.
- **Azure Deployable**: easy peering with Azure Route Server (two BGP peer IPs, active/active) or a Virtual WAN hub; simple NIC/subnet expectations.

### Features 

**Data Plane**
| Feature Name                                  | Phase / Release |
| --------------------------------------------- | --------------- |
| Static routing table (IPv4)                   | MVP             |
| Interface mapping (loopback + virtual ifaces) | MVP             |
| Localhost multi-instance support (127.x.x.x)  | MVP             |
| Static + dynamic route merging (RIB/FIB sync) | v1              |
| Policy routing (match src/dst/next-hop)       | v2              |
| NAT simulation (SNAT/DNAT)                    | v2              |
| ECMP / load balancing (5-tuple hash)          | v2              |
| Health probes (ICMP/TCP reachability)         | v2              |
| Traffic shaping / latency simulation          | v2              |

**Control Plane**
| Feature Name                           | Phase / Release |
| -------------------------------------- | --------------- |
| BGP single-AF IPv4 unicast (eBGP)      | v1              |
| BGP timers (keepalive/hold)            | v1              |
| Dual-peer setup for Azure Route Server | v1              |
| Prefix-list and route-map filtering    | v1              |
| Route refresh & graceful restart       | v2              |
| BGP multipath & communities            | v2              |
| iBGP & multi-hop eBGP support          | v2              |
| IPv6 unicast (dual stack)              | v2              |
| OSPF/RIP integration (optional)        | v2              |

**Management Plane**
| Feature Name                                   | Phase / Release |
| ---------------------------------------------- | --------------- |
| Virtual environment setup & dependency install | MVP             |
| Config template & first-time setup logic       | MVP             |
| Start/Stop/Kill/Restart controller (REPL)      | MVP             |
| Router heartbeat (status + freshness)          | MVP             |
| Logging & basic metrics (console + file)       | MVP             |
| REST admin API (/status, /routes, /peers)      | v1              |
| Prometheus metrics endpoint (/metrics)         | v1              |
| JSON config validation (Pydantic)              | v1              |
| Route reload & hot config updates              | v1              |
| Structured JSON logging with timestamps        | v1              |
| Container build (Dockerfile + systemd unit)    | v2              |
| Azure Monitor / Log Analytics exporter         | v2              |
| RBAC + token auth for REST API                 | v2              |
| Snapshot / restore (RIB & config export)       | v2              |
| Runtime upgrades (zero-loss restart)           | v2              |
| Event streaming to Azure Event Hub             | v2              |
| Audit logs + crash recovery                    | v2              |

### Run Locally 
- To explore the router you can run this locally. 
- Ensure you are in the router folder: `cd .\custom-services\my-azure-router\`.
- Run `python start_router.py`.
- After you see `router> [router] Router process starting ...`, you can send a command to the router process. 
- You can interact with the router using commands such as: `start`, `stop`, `kill`, `router-status`, `q` or `quit`.

</br>

---

**Version:** 0.1.0  
**Last Updated:** October, 2025